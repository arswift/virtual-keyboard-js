(()=>{"use strict";const t=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","IntlYen","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","MetaLeft","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"],e=["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","Del","CapsLock","a","s","d","f","g","h","j","k","l",";","'","Enter","ShiftL","z","x","c","v","b","n","m",",",".","/","↑","ShiftR","CtrlL","Win","AltL","Space","AltR","←","↓","→","CtrlR"],s=["ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\","Del","CapsLock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter","ShiftL","я","ч","с","м","и","т","ь","б","ю",".","↑","ShiftR","CtrlL","Win","AltL","Space","AltR","←","↓","→","CtrlR"],i=(t,e)=>{const s={};for(let i=0;i<e.length;i+=1)s[e[i]]=t[i];return s},r=i(e,s),n=i(s,e),o=i(s,t);o.Equal="=";const a=i(e,t);a.Equal="=",(()=>{const t=document.createElement("div");t.classList.add("wrapper"),t.insertAdjacentHTML("beforeend","<h1>RSS Virtual Keyboard</h1>"),t.insertAdjacentHTML("beforeend",'<textarea class="input" autofocus></textarea>'),document.body.append(t)})();const c=document.querySelector(".input"),l=new class{constructor({input:t,codeDict:e,dictEn:s,dictRu:i,shiftRuNorm:r,shiftRuReversed:n,shiftEnNorm:o,shiftEnReversed:a,shiftRuCode:c,shiftEnCode:l,ruToEng:h,engToRu:p,keyboardRu:u,keyboardEn:d}){this.properties.input=t,this.elements.ruDict=i,this.elements.enDict=s,this.elements.codeDict=e,this.elements.shiftRu=r,this.elements.shiftrevRu=n,this.elements.shiftEn=o,this.elements.shiftrevEn=a,this.elements.shiftRuCode=c,this.elements.shiftEnCode=l,this.elements.ruToEng=h,this.elements.engToRu=p,this.elements.keyboardRu=u,this.elements.keyboardEn=d}elements={keysContainer:null,keys:[]};properties={value:"",capsLock:!1,shift:!1,lang:"ru",curShift:null,curRShift:null,curKeyboard:null,curShiftCode:null};init(){this.properties.curKeyboard=this.elements.keyboardRu,this.properties.curShift=this.elements.shiftRu,this.properties.curRShift=this.elements.shiftrevRu,this.properties.curShiftCode=this.elements.shiftRuCode,this.generateKeyboard(),this.properties.lang=localStorage.getItem("lang")||"ru",window.addEventListener("keydown",(t=>{this.keyboardPressHandler(t)})),window.addEventListener("keyup",(t=>{this.elements.keys.forEach((e=>{e.textContent===this.properties.curKeyboard[t.code]||e.textContent===this.properties.curShiftCode[t.code]||e.textContent.toLowerCase()===this.properties.curKeyboard[t.code]?e.classList.remove("active"):"Ctrl"!==e.textContent&&"Alt"!==e.textContent&&"Shift"!==e.textContent&&""!==e.textContent||!e.classList.contains(t.code)?"Del"===e.textContent&&"Delete"===t.code&&e.classList.remove("active"):(e.classList.remove("active"),"ShiftLeft"!==t.code&&"ShiftRight"!==t.code||this.offShift())}))})),"ru"!==this.properties.lang&&(this.properties.lang="ru",this.switchLang())}generateKeyboard(){const t=document.querySelector(".wrapper");this.elements.keysContainer=document.createElement("div"),this.elements.keysContainer.classList.add("keyboard"),this.elements.keysContainer.append(this.createKeys()),t.append(this.elements.keysContainer),this.elements.keys=t.querySelectorAll(".key"),t.insertAdjacentHTML("beforeend",'<p class="description">Клавиатура создана в операционной системе Windows</p>'),t.insertAdjacentHTML("beforeend",'<p class="language">Для переключения языка комбинация: левыe ctrl + alt</p>')}keyboardPressHandler(t){const e=document.querySelector(".ControlLeft"),s=document.querySelector(".AltLeft");this.elements.keys.forEach((i=>{if(t.preventDefault(),i.textContent===this.properties.curKeyboard[t.code]||i.textContent===this.properties.curShiftCode[t.code]||i.textContent.toLowerCase()===this.properties.curKeyboard[t.code])switch(i.classList.add("active"),t.code){case"Backspace":this.backSpace();break;case"Tab":this.inputValue("    ");break;case"Delete":this.del();break;case"CapsLock":this.toggleCapsLock();break;case"Enter":this.inputValue("\n");break;case"MetaLeft":break;default:this.inputValue(i.textContent)}else if(("Ctrl"===i.textContent||"Alt"===i.textContent||"Shift"===i.textContent||""===i.textContent)&&i.classList.contains(t.code))switch(i.classList.add("active"),t.code){case"ShiftLeft":case"ShiftRight":this.onShift();break;case"ControlLeft":s.classList.contains("active")&&this.switchLang();break;case"ControlRight":case"AltRight":default:break;case"AltLeft":e.classList.contains("active")&&this.switchLang();break;case"Space":this.inputValue(" ")}}))}createKeys(){const t=document.createDocumentFragment();return this.elements.ruDict.forEach((e=>{const s=document.createElement("button");switch(s.classList.add("key"),s.setAttribute("type","button"),s.textContent=e,e){case"Backspace":s.classList.add("back"),s.addEventListener("click",(()=>{this.backSpace()}));break;case"Tab":s.classList.add("m"),s.addEventListener("click",(()=>{this.inputValue("    ")}));break;case"Del":s.addEventListener("click",(()=>{this.del()}));break;case"CapsLock":s.classList.add("xl","caps"),s.addEventListener("click",(()=>{this.toggleCapsLock()}));break;case"Enter":s.classList.add("xxl"),s.addEventListener("click",(()=>{this.inputValue("\n")}));break;case"ShiftL":s.classList.add("xl","ShiftLeft"),s.textContent="Shift",s.addEventListener("mousedown",(()=>{this.onShift()})),s.addEventListener("mouseup",(()=>{this.offShift()})),s.addEventListener("mouseout",(()=>{this.offShift()}));break;case"ShiftR":s.classList.add("xxl","ShiftRight"),s.textContent="Shift",s.addEventListener("mousedown",(()=>{this.onShift()})),s.addEventListener("mouseup",(()=>{this.offShift()}));break;case"CtrlL":s.classList.add("l","ControlLeft"),s.textContent="Ctrl";break;case"CtrlR":s.classList.add("l","ControlRight"),s.textContent="Ctrl";break;case"Win":s.classList.add("l");break;case"AltL":s.classList.add("l","AltLeft"),s.textContent="Alt";break;case"AltR":s.classList.add("l","AltRight"),s.textContent="Alt";break;case"Space":s.classList.add("Space"),s.textContent="",s.addEventListener("click",(()=>{this.inputValue(" ")}));break;default:s.textContent=e.toLowerCase(),s.classList.add("letter"),s.addEventListener("click",(t=>{this.inputValue(t.target.textContent)}))}t.append(s)})),t}toggleCapsLock(){this.properties.capsLock=!this.properties.capsLock;const t=document.querySelectorAll(".letter");document.querySelector(".caps").classList.toggle("caps-active"),t.forEach((t=>{t.textContent=this.properties.capsLock?t.textContent.toUpperCase():t.textContent.toLowerCase()}))}onShift(){this.properties.capsLock?this.properties.shift=!1:this.properties.shift=!0,this.toggleShift()}offShift(){this.properties.capsLock?this.properties.shift=!0:this.properties.shift=!1,this.toggleShift()}toggleShift(){document.querySelectorAll(".letter").forEach((t=>{t.textContent=this.properties.shift?t.textContent.toUpperCase():t.textContent.toLowerCase()})),document.querySelectorAll(".key").forEach((t=>{this.properties.shift&&this.properties.curShift[t.textContent]?t.textContent=this.properties.curShift[t.textContent]:!this.properties.shift&&this.properties.curRShift[t.textContent]&&(t.textContent=this.properties.curRShift[t.textContent])}))}inputValue(t){const e=this.properties.input.selectionStart,s=this.properties.input.selectionEnd,i=this.properties.value;i.length+1!==e?this.properties.value=i.slice(0,e)+t+i.slice(s):this.properties.value+=t,this.properties.input.value=this.properties.value,this.properties.input.setSelectionRange(e+t.length,e+t.length)}backSpace(){const t=this.properties.input.selectionStart,e=this.properties.input.selectionEnd,s=this.properties.value;this.properties.value=t===e?s.slice(0,t-1)+s.slice(e):s.slice(0,t)+s.slice(e),this.properties.input.value=this.properties.value,e?this.properties.input.setSelectionRange(t-1,t-1):this.properties.input.setSelectionRange(t,t)}del(){const t=this.properties.input.selectionStart,e=this.properties.input.selectionEnd,s=this.properties.value;return s.length<=1||t<=1&&t===e||(this.properties.value=t===e?s.slice(0,t)+s.slice(e+1):s.slice(0,t)+s.slice(e),this.properties.input.value=this.properties.value),this.properties.input.setSelectionRange(t,t)}switchLang(){let t=!1;this.properties.capsLock&&(this.toggleCapsLock(),t=!0),"ru"===this.properties.lang?(this.properties.lang="en",this.properties.curShift=this.elements.shiftEn,this.properties.curRShift=this.elements.shiftrevEn,this.properties.curShiftCode=this.elements.shiftEnCode,this.properties.curKeyboard=this.elements.keyboardEn):(this.properties.lang="ru",this.properties.curShift=this.elements.shiftRu,this.properties.curRShift=this.elements.shiftrevRu,this.properties.curShiftCode=this.elements.shiftRuCode,this.properties.curKeyboard=this.elements.keyboardRu);const e="en"===this.properties.lang?this.elements.ruToEng:this.elements.engToRu;this.elements.keys.forEach((t=>{"Shift"!==t.textContent&&"Alt"!==t.textContent&&"Ctrl"!==t.textContent&&(t.textContent=e[t.textContent])})),t&&this.toggleCapsLock(),this.setlocal()}setlocal(){localStorage.setItem("lang",this.properties.lang)}}({input:c,codeDict:t,dictEn:e,dictRu:s,shiftRuNorm:{1:"!",2:'"',3:"№",4:";",5:"%",6:":",7:"?",8:"*",9:"(",0:")","-":"_","=":"+",".":",","\\":"/"},shiftRuReversed:{"!":"1",'"':"2","№":"3",";":"4","%":"5",":":"6","?":"7","*":"8","(":"9",")":"0",_:"-","+":"=",",":".","/":"\\"},shiftEnNorm:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",",":"<",".":">","\\":"|","[":"{","]":"}",";":":","'":'"',"/":"?"},shiftEnReversed:{"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=","<":",",">":".","|":"\\","{":"[","}":"]",":":";",'"':"'","?":"/"},shiftRuCode:{Digit1:"!",Digit2:'"',Digit3:"№",Digit4:";",Digit5:"%",Digit6:":",Digit7:"?",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",IntlYen:"+",Equal:"+",Slash:",",Backslash:"/"},shiftEnCode:{Backquote:"~",Digit1:"!",Digit2:"@",Digit3:"#",Digit4:"$",Digit5:"%",Digit6:"^",Digit7:"&",Digit8:"*",Digit9:"(",Digit0:")",Minus:"_",IntlYen:"+",Equal:"+",Period:">",Comma:"<",Backslash:"|",BracketLeft:"{",BracketRight:"}",Semicolon:":",Quote:'"',Slash:"?"},ruToEng:r,engToRu:n,keyboardRu:o,keyboardEn:a});l.init(),c.addEventListener("blur",(()=>{c.focus()}))})();